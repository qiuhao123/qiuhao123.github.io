<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Database Normalization"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@"/>



  	<meta property="og:title" content="Database Normalization &middot; Qiuhao Jin" />
  	<meta property="og:site_name" content="Qiuhao Jin" />
  	<meta property="og:url" content="https://qiuhao123.github.io/spotify_db_normalization/" />
    
    
        
            <meta property="og:image" content="/images/cover.png"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-10-05T16:06:23-04:00" />

    
    

    <title>Database Normalization &middot; Qiuhao Jin</title>

    
    <meta name="description" content="Introduction When developing the schema of a relational database, one of the most important aspects of to be taken into accountis to ensure that duplication is " />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/images/favicon.ico">
	  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/css/nav.css" />

    

    

    
      
          <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Qiuhao Jin" />
      
      
    
    <meta name="generator" content="Hugo 0.74.3" />

    <link rel="canonical" href="https://qiuhao123.github.io/spotify_db_normalization/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name":  null ,
        "logo": "https://qiuhao123.github.io/images/logo.png"
    },
    "author": {
        "@type": "Person",
        "name":  null ,
        
        "image": {
            "@type": "ImageObject",
            "url": "https://qiuhao123.github.io/images/logo.png",
            "width": 250,
            "height": 250
        }, 
        
        "url":  null ,
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "Database Normalization",
    "name": "Database Normalization",
    "wordCount":  1391 ,
    "timeRequired": "PT7M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "https://qiuhao123.github.io/spotify_db_normalization/",
    "datePublished": "2020-10-05T16:06Z",
    "dateModified": "2020-10-05T16:06Z",
    
    
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://qiuhao123.github.io/spotify_db_normalization/"
    }
}
    </script>
    


    

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/home_price/">Home_price</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/personal_website_blog/">Build a personal website with Hugo </a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/contact/">Contact</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/credit_risk/">Credit Risk Modeling</a>
            </li>
        
            
            <li class="nav-opened nav-current" role="presentation">
            	<a href="/spotify_db_normalization/">Database Normalization</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/euler-project/">Euler-Project</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/ad-analysis/">Ad Analysis</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/insect_image/">Insect Image Recognition</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/introduction_to_time_series_forecasting/">Introduction to Time Series Forecasting</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/malaria/">Malaria</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/mortality/">Mortality Prediction with Neural Network</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/phd_analysis/">Phd_data_dashboard</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/starwar/">Star War Data Acuisiqtion</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">





<header class="main-header post-head no-cover">
    <nav class="main-nav overlay clearfix">


      
        <a class="blog-logo" href="https://qiuhao123.github.io/"><img src="/images/logo.png" alt="Home" /></a>
      
      
          <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
      
    </nav>

    


</header>



<main class="content" role="main">




  <article class="post ">
    <header class="post-header">
      <nav class="breadcrumb">
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/spotify_db_normalization/">Database Normalization</a></li>
              
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
      </nav>


        <h1 class="post-title">Database Normalization</h1>
        <small></small>

        <section class="post-meta">
        
         
        </section>
    </header>

    <section class="post-content">


<h3 id="introduction"><strong>Introduction</strong></h3>
<p>When developing the schema of a relational database, one of the most important aspects of to be taken into  accountis to ensure that duplication is minimized. There are two reasons:</p>
<ul>
<li>reduce the amount of required storage for data</li>
<li>avoid unecessary data conflict that can be casued by the data duplication</li>
</ul>
<h3 id="normalization-in-database"><strong>Normalization in Database</strong></h3>
<p>database normalization is one of the technique that can ensure the above two points. The core idea of database normalization is to divide the table into smaller subtables and store pointers to the data rather replicating it. In order to illustrate this concept, we are going to use <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-01-21/readme.md">Spotify dataset</a></p>
<h3 id="take-a-look-at-the-original-data">Take a look at the original data</h3>
<pre><code class="language-python " data-lang="python ">df = pd.read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-01-21/spotify_songs.csv')
print(df.shape)
df.head()
</code></pre><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">track_id</th>
<th align="left">track_name</th>
<th align="left">track_artist</th>
<th align="right">track_popularity</th>
<th align="left">track_album_id</th>
<th align="left">track_album_name</th>
<th align="left">track_album_release_date</th>
<th align="left">playlist_name</th>
<th align="left">playlist_id</th>
<th align="left">playlist_genre</th>
<th align="left">playlist_subgenre</th>
<th align="right">danceability</th>
<th align="right">energy</th>
<th align="right">key</th>
<th align="right">loudness</th>
<th align="right">mode</th>
<th align="right">speechiness</th>
<th align="right">acousticness</th>
<th align="right">instrumentalness</th>
<th align="right">liveness</th>
<th align="right">valence</th>
<th align="right">tempo</th>
<th align="right">duration_ms</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">6f807x0ima9a1j3VPbc7VN</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) - Loud Luxury Remix</td>
<td align="left">Ed Sheeran</td>
<td align="right">66</td>
<td align="left">2oCs0DGTsRO98Gh5ZSl2Cx</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) [Loud Luxury Remix]</td>
<td align="left">2019-06-14</td>
<td align="left">Pop Remix</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
<td align="right">0.748</td>
<td align="right">0.916</td>
<td align="right">6</td>
<td align="right">-2.634</td>
<td align="right">1</td>
<td align="right">0.0583</td>
<td align="right">0.102</td>
<td align="right">0</td>
<td align="right">0.0653</td>
<td align="right">0.518</td>
<td align="right">122.036</td>
<td align="right">194754</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">0r7CVbZTWZgbTCYdfa2P31</td>
<td align="left">Memories - Dillon Francis Remix</td>
<td align="left">Maroon 5</td>
<td align="right">67</td>
<td align="left">63rPSO264uRjW1X5E6cWv6</td>
<td align="left">Memories (Dillon Francis Remix)</td>
<td align="left">2019-12-13</td>
<td align="left">Pop Remix</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
<td align="right">0.726</td>
<td align="right">0.815</td>
<td align="right">11</td>
<td align="right">-4.969</td>
<td align="right">1</td>
<td align="right">0.0373</td>
<td align="right">0.0724</td>
<td align="right">0.00421</td>
<td align="right">0.357</td>
<td align="right">0.693</td>
<td align="right">99.972</td>
<td align="right">162600</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">1z1Hg7Vb0AhHDiEmnDE79l</td>
<td align="left">All the Time - Don Diablo Remix</td>
<td align="left">Zara Larsson</td>
<td align="right">70</td>
<td align="left">1HoSmj2eLcsrR0vE9gThr4</td>
<td align="left">All the Time (Don Diablo Remix)</td>
<td align="left">2019-07-05</td>
<td align="left">Pop Remix</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
<td align="right">0.675</td>
<td align="right">0.931</td>
<td align="right">1</td>
<td align="right">-3.432</td>
<td align="right">0</td>
<td align="right">0.0742</td>
<td align="right">0.0794</td>
<td align="right">2.33e-05</td>
<td align="right">0.11</td>
<td align="right">0.613</td>
<td align="right">124.008</td>
<td align="right">176616</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">75FpbthrwQmzHlBJLuGdC7</td>
<td align="left">Call You Mine - Keanu Silva Remix</td>
<td align="left">The Chainsmokers</td>
<td align="right">60</td>
<td align="left">1nqYsOef1yKKuGOVchbsk6</td>
<td align="left">Call You Mine - The Remixes</td>
<td align="left">2019-07-19</td>
<td align="left">Pop Remix</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
<td align="right">0.718</td>
<td align="right">0.93</td>
<td align="right">7</td>
<td align="right">-3.778</td>
<td align="right">1</td>
<td align="right">0.102</td>
<td align="right">0.0287</td>
<td align="right">9.43e-06</td>
<td align="right">0.204</td>
<td align="right">0.277</td>
<td align="right">121.956</td>
<td align="right">169093</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">1e8PAfcKUYoKkxPhrHqw4x</td>
<td align="left">Someone You Loved - Future Humans Remix</td>
<td align="left">Lewis Capaldi</td>
<td align="right">69</td>
<td align="left">7m7vv9wlQ4i0LFuJiE2zsQ</td>
<td align="left">Someone You Loved (Future Humans Remix)</td>
<td align="left">2019-03-05</td>
<td align="left">Pop Remix</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
<td align="right">0.65</td>
<td align="right">0.833</td>
<td align="right">1</td>
<td align="right">-4.672</td>
<td align="right">1</td>
<td align="right">0.0359</td>
<td align="right">0.0803</td>
<td align="right">0</td>
<td align="right">0.0833</td>
<td align="right">0.725</td>
<td align="right">123.976</td>
<td align="right">189052</td>
</tr>
</tbody>
</table>
<p>each row represents a track. However, Not all columns are dedicate to the attribute of each tracks. For example, playlist_id, playlist genre dedicates to playlist attributes. Track_album_name, track_albumn_release_date dedicate to album attributes. It shows that our dataset is not in the Thrid Normal form.</p>
<h3 id="types-of-database-normalization"><strong>Types of database normalization</strong></h3>
<p>These are various database &ldquo;normal&rdquo; forms. Each normal forms has an importance which helps in optimizing the database to save storage and reduce redundancies</p>
<h4 id="first-normal-form1nf">First Normal Form(1NF)</h4>
<p>the first normal form simply says that each cell of a table should contain exactly one value. According to our original spotify dataset table, it appears to satisfy the first normal form.</p>
<h4 id="second-normal-form2nf">Second Normal Form(2NF)</h4>
<p>For  a table to be in second normal form, the following 2 conditions are to be met:</p>
<ol>
<li>table should be in first normal form</li>
<li>the primary key of the table should compose of exactly 1 column</li>
</ol>
<p>a primary key is a set fo columns that uniquely identifies a row. Basically no 2 rows have the same primary keys. Let&rsquo;s take a look at the dataset.</p>
<p>FIrst, we would like to separate the original dataframe into the following dataframe:</p>
<ul>
<li>
<p>track_df: contain all attributes of specific track</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#select track attributes </span>
track_df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">4</span>]<span style="color:#f92672">.</span>drop_duplicates()
attribute_df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">11</span>:]<span style="color:#f92672">.</span>drop_duplicates()
<span style="color:#75715e">#concatenate all columns together</span>
track_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([track_df,attribute_df],axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>drop_duplicates()
track_df<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">track_id</th>
<th align="left">track_name</th>
<th align="left">track_artist</th>
<th align="right">track_popularity</th>
<th align="right">danceability</th>
<th align="right">energy</th>
<th align="right">key</th>
<th align="right">loudness</th>
<th align="right">mode</th>
<th align="right">speechiness</th>
<th align="right">acousticness</th>
<th align="right">instrumentalness</th>
<th align="right">liveness</th>
<th align="right">valence</th>
<th align="right">tempo</th>
<th align="right">duration_ms</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">6f807x0ima9a1j3VPbc7VN</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) - Loud Luxury Remix</td>
<td align="left">Ed Sheeran</td>
<td align="right">66</td>
<td align="right">0.748</td>
<td align="right">0.916</td>
<td align="right">6</td>
<td align="right">-2.634</td>
<td align="right">1</td>
<td align="right">0.0583</td>
<td align="right">0.102</td>
<td align="right">0</td>
<td align="right">0.0653</td>
<td align="right">0.518</td>
<td align="right">122.036</td>
<td align="right">194754</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">0r7CVbZTWZgbTCYdfa2P31</td>
<td align="left">Memories - Dillon Francis Remix</td>
<td align="left">Maroon 5</td>
<td align="right">67</td>
<td align="right">0.726</td>
<td align="right">0.815</td>
<td align="right">11</td>
<td align="right">-4.969</td>
<td align="right">1</td>
<td align="right">0.0373</td>
<td align="right">0.0724</td>
<td align="right">0.00421</td>
<td align="right">0.357</td>
<td align="right">0.693</td>
<td align="right">99.972</td>
<td align="right">162600</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">1z1Hg7Vb0AhHDiEmnDE79l</td>
<td align="left">All the Time - Don Diablo Remix</td>
<td align="left">Zara Larsson</td>
<td align="right">70</td>
<td align="right">0.675</td>
<td align="right">0.931</td>
<td align="right">1</td>
<td align="right">-3.432</td>
<td align="right">0</td>
<td align="right">0.0742</td>
<td align="right">0.0794</td>
<td align="right">2.33e-05</td>
<td align="right">0.11</td>
<td align="right">0.613</td>
<td align="right">124.008</td>
<td align="right">176616</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">75FpbthrwQmzHlBJLuGdC7</td>
<td align="left">Call You Mine - Keanu Silva Remix</td>
<td align="left">The Chainsmokers</td>
<td align="right">60</td>
<td align="right">0.718</td>
<td align="right">0.93</td>
<td align="right">7</td>
<td align="right">-3.778</td>
<td align="right">1</td>
<td align="right">0.102</td>
<td align="right">0.0287</td>
<td align="right">9.43e-06</td>
<td align="right">0.204</td>
<td align="right">0.277</td>
<td align="right">121.956</td>
<td align="right">169093</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">1e8PAfcKUYoKkxPhrHqw4x</td>
<td align="left">Someone You Loved - Future Humans Remix</td>
<td align="left">Lewis Capaldi</td>
<td align="right">69</td>
<td align="right">0.65</td>
<td align="right">0.833</td>
<td align="right">1</td>
<td align="right">-4.672</td>
<td align="right">1</td>
<td align="right">0.0359</td>
<td align="right">0.0803</td>
<td align="right">0</td>
<td align="right">0.0833</td>
<td align="right">0.725</td>
<td align="right">123.976</td>
<td align="right">189052</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>album_df: contain all attributes of specific album</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#select album attributes</span>
album_df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">7</span>]<span style="color:#f92672">.</span>drop_duplicates()
album_df<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">track_album_id</th>
<th align="left">track_album_name</th>
<th align="left">track_album_release_date</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">2oCs0DGTsRO98Gh5ZSl2Cx</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) [Loud Luxury Remix]</td>
<td align="left">2019-06-14</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">63rPSO264uRjW1X5E6cWv6</td>
<td align="left">Memories (Dillon Francis Remix)</td>
<td align="left">2019-12-13</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">1HoSmj2eLcsrR0vE9gThr4</td>
<td align="left">All the Time (Don Diablo Remix)</td>
<td align="left">2019-07-05</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">1nqYsOef1yKKuGOVchbsk6</td>
<td align="left">Call You Mine - The Remixes</td>
<td align="left">2019-07-19</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">7m7vv9wlQ4i0LFuJiE2zsQ</td>
<td align="left">Someone You Loved (Future Humans Remix)</td>
<td align="left">2019-03-05</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Playlist_df: contain all attributes of specific playlist</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#select playlist attributes</span>
playlist_df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">7</span>:<span style="color:#ae81ff">11</span>]<span style="color:#f92672">.</span>drop_duplicates()
playlist_df<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">playlist_name</th>
<th align="left">playlist_id</th>
<th align="left">playlist_genre</th>
<th align="left">playlist_subgenre</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">Pop Remix</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
</tr>
<tr>
<td align="right">70</td>
<td align="left">Dance Pop</td>
<td align="left">37i9dQZF1DWZQaaqNMbbXa</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
</tr>
<tr>
<td align="right">167</td>
<td align="left">Dance Room</td>
<td align="left">37i9dQZF1DX2ENAPP1Tyed</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
</tr>
<tr>
<td align="right">223</td>
<td align="left">Cardio</td>
<td align="left">37i9dQZF1DWSJHnPb1f0X3</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
</tr>
<tr>
<td align="right">272</td>
<td align="left">Dance Pop Hits</td>
<td align="left">37i9dQZF1DX6pH08wMhkaI</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>df_track_album: connect track_df and album_df</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#select track_id and track_albumn_id to link the track_df and album_df</span>
df_track_album <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">4</span>]]<span style="color:#f92672">.</span>drop_duplicates()
df_track_album<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">track_id</th>
<th align="left">track_album_id</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">6f807x0ima9a1j3VPbc7VN</td>
<td align="left">2oCs0DGTsRO98Gh5ZSl2Cx</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">0r7CVbZTWZgbTCYdfa2P31</td>
<td align="left">63rPSO264uRjW1X5E6cWv6</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">1z1Hg7Vb0AhHDiEmnDE79l</td>
<td align="left">1HoSmj2eLcsrR0vE9gThr4</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">75FpbthrwQmzHlBJLuGdC7</td>
<td align="left">1nqYsOef1yKKuGOVchbsk6</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">1e8PAfcKUYoKkxPhrHqw4x</td>
<td align="left">7m7vv9wlQ4i0LFuJiE2zsQ</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>df_track_playlist: connect track_df and playlist_df</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#select track_id and playlist_id to link the track_df and playlist_df</span>
df_track_playlist <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>iloc[:,[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">8</span>]]<span style="color:#f92672">.</span>drop_duplicates()
<span style="color:#66d9ef">print</span>(df_track_playlist<span style="color:#f92672">.</span>shape)
df_track_playlist<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">track_id</th>
<th align="left">playlist_id</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">6f807x0ima9a1j3VPbc7VN</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">0r7CVbZTWZgbTCYdfa2P31</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">1z1Hg7Vb0AhHDiEmnDE79l</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">75FpbthrwQmzHlBJLuGdC7</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">1e8PAfcKUYoKkxPhrHqw4x</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h4 id="third-normal-form3nf">Third Normal Form(3NF)</h4>
<p>Before we try to understand the details of third normal form, we have to understand the concept of a functional dependency on a table</p>
<p>column A is said to be functionally dependent on column B if changing the value of A may require a change in the value of column B. The third normal form avoids this by breaking this table into separate tables.</p>
<p>In playlist_df, column playlist_subgenere is dependent on playlist_genre. Thus, we have to separate two dataframe. In addition, each playlist can only belong to a single subgenre. Hence, it is the best that we separate all of the columns into different tables.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df_playlist_name <span style="color:#f92672">=</span> playlist_df<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>drop_duplicates()
<span style="color:#66d9ef">print</span>(df_playlist_name<span style="color:#f92672">.</span>shape) 
df_playlist_name<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">playlist_name</th>
<th align="left">playlist_id</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">Pop Remix</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
</tr>
<tr>
<td align="right">70</td>
<td align="left">Dance Pop</td>
<td align="left">37i9dQZF1DWZQaaqNMbbXa</td>
</tr>
<tr>
<td align="right">167</td>
<td align="left">Dance Room</td>
<td align="left">37i9dQZF1DX2ENAPP1Tyed</td>
</tr>
<tr>
<td align="right">223</td>
<td align="left">Cardio</td>
<td align="left">37i9dQZF1DWSJHnPb1f0X3</td>
</tr>
<tr>
<td align="right">272</td>
<td align="left">Dance Pop Hits</td>
<td align="left">37i9dQZF1DX6pH08wMhkaI</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#one track can only belong to one genre</span>
df_playlist_genre <span style="color:#f92672">=</span> playlist_df<span style="color:#f92672">.</span>iloc[:,[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>]]<span style="color:#f92672">.</span>drop_duplicates(subset<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;playlist_id&#39;</span>,keep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;first&#39;</span>)
<span style="color:#66d9ef">print</span>(df_playlist_genre<span style="color:#f92672">.</span>shape)
df_playlist_genre<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">playlist_id</th>
<th align="left">playlist_genre</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">pop</td>
</tr>
<tr>
<td align="right">70</td>
<td align="left">37i9dQZF1DWZQaaqNMbbXa</td>
<td align="left">pop</td>
</tr>
<tr>
<td align="right">167</td>
<td align="left">37i9dQZF1DX2ENAPP1Tyed</td>
<td align="left">pop</td>
</tr>
<tr>
<td align="right">223</td>
<td align="left">37i9dQZF1DWSJHnPb1f0X3</td>
<td align="left">pop</td>
</tr>
<tr>
<td align="right">272</td>
<td align="left">37i9dQZF1DX6pH08wMhkaI</td>
<td align="left">pop</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#separate into genre  vs subgenre</span>
df_genre_sub <span style="color:#f92672">=</span> playlist_df<span style="color:#f92672">.</span>iloc[:,<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>drop_duplicates(subset<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;playlist_subgenre&#39;</span>,keep<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;first&#39;</span>)
<span style="color:#66d9ef">print</span>(df_genre_sub<span style="color:#f92672">.</span>shape)
df_genre_sub<span style="color:#f92672">.</span>head()
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">playlist_genre</th>
<th align="left">playlist_subgenre</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">pop</td>
<td align="left">dance pop</td>
</tr>
<tr>
<td align="right">1298</td>
<td align="left">pop</td>
<td align="left">post-teen pop</td>
</tr>
<tr>
<td align="right">2427</td>
<td align="left">pop</td>
<td align="left">electropop</td>
</tr>
<tr>
<td align="right">3835</td>
<td align="left">pop</td>
<td align="left">indie poptimism</td>
</tr>
<tr>
<td align="right">5507</td>
<td align="left">rap</td>
<td align="left">hip hop</td>
</tr>
</tbody>
</table>
<h4 id="denormalization">Denormalization</h4>
<p>Now that we have all the tables separrated and deduplicated, it is appropriate that we combine all the subtables into a combined tables to make sure that we are able to convert to the original table format</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">final_df<span style="color:#f92672">=</span>(
    df_track_attribute<span style="color:#f92672">.</span>
    merge(df_popularity)<span style="color:#f92672">.</span>
    merge(df_track_playlist)<span style="color:#f92672">.</span>
    merge(df_track_info)<span style="color:#f92672">.</span>
    merge(df_playlist_name,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;playlist_id&#39;</span>)<span style="color:#f92672">.</span>
    merge(df_playlist_genre,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;playlist_id&#39;</span>)<span style="color:#f92672">.</span>
    merge(df_track_album,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;track_id&#39;</span>)<span style="color:#f92672">.</span>
    merge(album_df,on<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;track_album_id&#39;</span>)
    
) 
</code></pre></div><table>
<thead>
<tr>
<th align="right"></th>
<th align="left">track_id</th>
<th align="right">danceability</th>
<th align="right">energy</th>
<th align="right">key</th>
<th align="right">loudness</th>
<th align="right">mode</th>
<th align="right">speechiness</th>
<th align="right">acousticness</th>
<th align="right">instrumentalness</th>
<th align="right">liveness</th>
<th align="right">valence</th>
<th align="right">tempo</th>
<th align="right">duration_ms</th>
<th align="right">track_popularity</th>
<th align="left">playlist_id</th>
<th align="left">track_name</th>
<th align="left">track_artist</th>
<th align="left">playlist_name</th>
<th align="left">playlist_genre</th>
<th align="left">track_album_id</th>
<th align="left">track_album_name</th>
<th align="left">track_album_release_date</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0</td>
<td align="left">6f807x0ima9a1j3VPbc7VN</td>
<td align="right">0.748</td>
<td align="right">0.916</td>
<td align="right">6</td>
<td align="right">-2.634</td>
<td align="right">1</td>
<td align="right">0.0583</td>
<td align="right">0.102</td>
<td align="right">0</td>
<td align="right">0.0653</td>
<td align="right">0.518</td>
<td align="right">122.036</td>
<td align="right">194754</td>
<td align="right">66</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) - Loud Luxury Remix</td>
<td align="left">Ed Sheeran</td>
<td align="left">Pop Remix</td>
<td align="left">pop</td>
<td align="left">2oCs0DGTsRO98Gh5ZSl2Cx</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) [Loud Luxury Remix]</td>
<td align="left">2019-06-14</td>
</tr>
<tr>
<td align="right">1</td>
<td align="left">6f807x0ima9a1j3VPbc7VN</td>
<td align="right">0.748</td>
<td align="right">0.916</td>
<td align="right">6</td>
<td align="right">-2.634</td>
<td align="right">1</td>
<td align="right">0.0583</td>
<td align="right">0.102</td>
<td align="right">0</td>
<td align="right">0.0653</td>
<td align="right">0.518</td>
<td align="right">122.036</td>
<td align="right">194754</td>
<td align="right">66</td>
<td align="left">4aUEH3uhbofktrFkXOOaKj</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) - Loud Luxury Remix</td>
<td align="left">Ed Sheeran</td>
<td align="left">Pop EDM Remixes</td>
<td align="left">edm</td>
<td align="left">2oCs0DGTsRO98Gh5ZSl2Cx</td>
<td align="left">I Don&rsquo;t Care (with Justin Bieber) [Loud Luxury Remix]</td>
<td align="left">2019-06-14</td>
</tr>
<tr>
<td align="right">2</td>
<td align="left">0r7CVbZTWZgbTCYdfa2P31</td>
<td align="right">0.726</td>
<td align="right">0.815</td>
<td align="right">11</td>
<td align="right">-4.969</td>
<td align="right">1</td>
<td align="right">0.0373</td>
<td align="right">0.0724</td>
<td align="right">0.00421</td>
<td align="right">0.357</td>
<td align="right">0.693</td>
<td align="right">99.972</td>
<td align="right">162600</td>
<td align="right">67</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">Memories - Dillon Francis Remix</td>
<td align="left">Maroon 5</td>
<td align="left">Pop Remix</td>
<td align="left">pop</td>
<td align="left">63rPSO264uRjW1X5E6cWv6</td>
<td align="left">Memories (Dillon Francis Remix)</td>
<td align="left">2019-12-13</td>
</tr>
<tr>
<td align="right">3</td>
<td align="left">0r7CVbZTWZgbTCYdfa2P31</td>
<td align="right">0.726</td>
<td align="right">0.815</td>
<td align="right">11</td>
<td align="right">-4.969</td>
<td align="right">1</td>
<td align="right">0.0373</td>
<td align="right">0.0724</td>
<td align="right">0.00421</td>
<td align="right">0.357</td>
<td align="right">0.693</td>
<td align="right">99.972</td>
<td align="right">162600</td>
<td align="right">67</td>
<td align="left">5CTzufLc0f6MufjKYrIaoO</td>
<td align="left">Memories - Dillon Francis Remix</td>
<td align="left">Maroon 5</td>
<td align="left">EDM House &amp; Dance</td>
<td align="left">edm</td>
<td align="left">63rPSO264uRjW1X5E6cWv6</td>
<td align="left">Memories (Dillon Francis Remix)</td>
<td align="left">2019-12-13</td>
</tr>
<tr>
<td align="right">4</td>
<td align="left">1z1Hg7Vb0AhHDiEmnDE79l</td>
<td align="right">0.675</td>
<td align="right">0.931</td>
<td align="right">1</td>
<td align="right">-3.432</td>
<td align="right">0</td>
<td align="right">0.0742</td>
<td align="right">0.0794</td>
<td align="right">2.33e-05</td>
<td align="right">0.11</td>
<td align="right">0.613</td>
<td align="right">124.008</td>
<td align="right">176616</td>
<td align="right">70</td>
<td align="left">37i9dQZF1DXcZDD7cfEKhW</td>
<td align="left">All the Time - Don Diablo Remix</td>
<td align="left">Zara Larsson</td>
<td align="left">Pop Remix</td>
<td align="left">pop</td>
<td align="left">1HoSmj2eLcsrR0vE9gThr4</td>
<td align="left">All the Time (Don Diablo Remix)</td>
<td align="left">2019-07-05</td>
</tr>
</tbody>
</table>
<p>Wow, we have successfully convert the data table into our original form. It shows that our process works!</p>
<h3 id="summary"><strong>Summary</strong></h3>
<p>The various form of database normalization are useful while designing the schema of a database in such a way that there is no data replication which may possibly lead to inconsistancies. While designing the schema for application, we should always think about how cna we make use of these forms.</p>









    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="https://qiuhao123.github.io/" style="background-image: url(/images/logo.png)"><span class="hidden">Qiuhao Jin's Picture</span></a>
    </figure>
    

    








<figure class="author-image">
    <a class="img" href="https://qiuhao123.github.io/" style="background-image: url(/images/logo.png)"><span class="hidden">Qiuhao Jin's Picture</span></a>
</figure>


<section class="author">
  <h4><a href="https://qiuhao123.github.io/">Qiuhao Jin</a></h4>
  
  <p>Read <a href="https://qiuhao123.github.io/">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Durham, NC, USA</span>
    
  </div>
</section>




    
<section class="share">
  <h4>Share this page</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Database%20Normalization&nbsp;-&nbsp;Qiuhao%20Jin&amp;url=https%3a%2f%2fqiuhao123.github.io%2fspotify_db_normalization%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fqiuhao123.github.io%2fspotify_db_normalization%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fqiuhao123.github.io%2fspotify_db_normalization%2f&amp;description=Database%20Normalization"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fqiuhao123.github.io%2fspotify_db_normalization%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    







  </footer>
</article>

</main>

<aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/starwar/">
          <section class="post">
              <h2>Star War Data Acuisiqtion</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/home_price/">
          <section class="post">
              <h2>Home_price</h2>
          </section>
      </a>
  
</aside>


    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Qiuhao Jin</a> © Qiuhao Jin Duke 2021</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
    
</body>
</html>

