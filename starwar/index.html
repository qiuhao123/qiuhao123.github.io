<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Star War Data Acuisiqtion"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@"/>



  	<meta property="og:title" content="Star War Data Acuisiqtion &middot; Qiuhao Jin" />
  	<meta property="og:site_name" content="Qiuhao Jin" />
  	<meta property="og:url" content="https://qiuhao123.github.io/starwar/" />
    
    
        
            <meta property="og:image" content="/images/cover.png"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2020-10-23T22:58:08-04:00" />

    
    

    <title>Star War Data Acuisiqtion &middot; Qiuhao Jin</title>

    
    <meta name="description" content="Introduction It is extremely important to learn how to accquire data from API using Request Package
Request package Request is a package to retreive data by mak" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="/images/favicon.ico">
	  <link rel="apple-touch-icon" href="/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="/css/nav.css" />

    

    

    
      
          <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Qiuhao Jin" />
      
      
    
    <meta name="generator" content="Hugo 0.74.3" />

    <link rel="canonical" href="https://qiuhao123.github.io/starwar/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name":  null ,
        "logo": "https://qiuhao123.github.io/images/logo.png"
    },
    "author": {
        "@type": "Person",
        "name":  null ,
        
        "image": {
            "@type": "ImageObject",
            "url": "https://qiuhao123.github.io/images/logo.png",
            "width": 250,
            "height": 250
        }, 
        
        "url":  null ,
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "Star War Data Acuisiqtion",
    "name": "Star War Data Acuisiqtion",
    "wordCount":  439 ,
    "timeRequired": "PT3M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "https://qiuhao123.github.io/starwar/",
    "datePublished": "2020-10-23T22:58Z",
    "dateModified": "2020-10-23T22:58Z",
    
    
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://qiuhao123.github.io/starwar/"
    }
}
    </script>
    


    

    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            <br />
            <li class="nav-opened" role="presentation">
            	<a href="/">Home</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/home_price/">Home_price</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/personal_website_blog/">Build a personal website with Hugo </a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/contact/">Contact</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/credit_risk/">Credit Risk Modeling</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/spotify_db_normalization/">Database Normalization</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/euler-project/">Euler-Project</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/ad-analysis/">Ad Analysis</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/insect_image/">Insect Image Recognition</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/introduction_to_time_series_forecasting/">Introduction to Time Series Forecasting</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/malaria/">Malaria</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/mortality/">Mortality Prediction with Neural Network</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/phd_analysis/">Phd_data_dashboard</a>
            </li>
        
            
            <li class="nav-opened nav-current" role="presentation">
            	<a href="/starwar/">Star War Data Acuisiqtion</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href="/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">





<header class="main-header post-head no-cover">
    <nav class="main-nav overlay clearfix">


      
        <a class="blog-logo" href="https://qiuhao123.github.io/"><img src="/images/logo.png" alt="Home" /></a>
      
      
          <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
      
    </nav>

    


</header>



<main class="content" role="main">




  <article class="post ">
    <header class="post-header">
      <nav class="breadcrumb">
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li><a href="/starwar/">Star War Data Acuisiqtion</a></li>
              
        
        
        
      </nav>


        <h1 class="post-title">Star War Data Acuisiqtion</h1>
        <small></small>

        <section class="post-meta">
        
         
        </section>
    </header>

    <section class="post-content">


<h3 id="introduction">Introduction</h3>
<p>It is extremely important to learn how to accquire data from API using Request Package</p>
<h3 id="request-package">Request package</h3>
<p>Request is a package to retreive data by making http request. I will use the Star War API as an example</p>
<h3 id="fectch-one-character-from-api">Fectch one character from API</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> requests
person <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://swapi.dev/api/people/1&#39;</span>)
person<span style="color:#f92672">.</span>json()
</code></pre></div><p><img src="/images/starwar/person.png" alt="image alter text"></p>
<p>The data retrieved from API is in Json format. It will be much clear if the data is in the table format. We can use    a json_normalize function from pandas package as following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
pd<span style="color:#f92672">.</span>json_normalize(person<span style="color:#f92672">.</span>json())
</code></pre></div><p><img src="/images/starwar/table_person.png" alt="image alter text"></p>
<h3 id="fetch-all-characters-from-api">Fetch all characters from API</h3>
<p>after we are able to fetch one character from StarWar API, we are then able to fetch all characters from Star War using a for loop. In order to understand the number of the characters in Star War API. There is a &ldquo;count&rdquo; key that we can check.</p>
<pre><code class="language-python " data-lang="python ">people = requests.get('https://swapi.dev/api/people')
print('there are total {} characters'.format(people.json()['count']))
</code></pre><p>After running the above code, there are total 82 characters. we then write a for loop to extract all the Star War characters. In addition, we will also check the success of retrieval process by retrieval code. If the code is 200 which means successful, if the code is 404 that means there is an error, we will continue to retrieve the next characters. After looping we will check if we have successfully retrieve all the characters from API by using assert.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_all_people</span>():
    starWar_people <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame()
    people <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://swapi.dev/api/people&#39;</span>)<span style="color:#f92672">.</span>json()
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(people[<span style="color:#e6db74">&#39;count&#39;</span>]):
        character <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://swapi.dev/api/people/&#39;</span> <span style="color:#f92672">+</span> str(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))
        <span style="color:#66d9ef">if</span> character<span style="color:#f92672">.</span>status_code <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span>:
            character_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>json_normalize(character<span style="color:#f92672">.</span>json())
            starWar_people <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([character_df,starWar_people])
        <span style="color:#66d9ef">elif</span> character<span style="color:#f92672">.</span>status_code <span style="color:#f92672">==</span> <span style="color:#ae81ff">404</span>:
            <span style="color:#66d9ef">continue</span>
    <span style="color:#66d9ef">assert</span>(len(starWar_people)<span style="color:#f92672">==</span>people[<span style="color:#e6db74">&#39;count&#39;</span>])
    <span style="color:#66d9ef">return</span> starWar_people
</code></pre></div><p>after running the above code, we have the following table</p>
<p><img src="/images/starwar/all__characters.png" alt="image alter text"></p>
<p>Now Let&rsquo;s take a look at the oldest character and all the movies that he is in. We will use &ldquo;birth_year&rdquo; to calculate the age of the character. It appears that there are some character with unknown birth year. We will ignore those characters in this case. The rest of the characters are all born BBY which stands for &ldquo;Before the Battle of Yavin&rdquo;. The larger the number means the older the character is. We can fetch the oldest character by following code</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> get_all_people()
valid_birth_df <span style="color:#f92672">=</span> df[df[<span style="color:#e6db74">&#39;birth_year&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>endswith(<span style="color:#e6db74">&#39;BBY&#39;</span>)]
oldest <span style="color:#f92672">=</span> valid_birth_df[valid_birth_df<span style="color:#f92672">.</span>birth_year <span style="color:#f92672">==</span> valid_birth_df[<span style="color:#e6db74">&#39;birth_year&#39;</span>]<span style="color:#f92672">.</span>max()]
</code></pre></div><p>After running the code, the oldest character is Yoda which has over 800 BBY. we will then use the following code to get all the name of the movie that Yoda has appeared.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">films <span style="color:#f92672">=</span> oldest[<span style="color:#e6db74">&#39;films&#39;</span>]<span style="color:#f92672">.</span>squeeze()
appeared_film <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> film <span style="color:#f92672">in</span> films:
    film <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(film)
    appeared_film<span style="color:#f92672">.</span>append(film<span style="color:#f92672">.</span>json()[<span style="color:#e6db74">&#39;title&#39;</span>])   
appeared_film
</code></pre></div><pre><code>['The Empire Strikes Back','Return of the Jedi','The Phantom Menace','Attack of the Clones','Revenge of the Sith']
</code></pre><p><strong>May the Force be with You!!</strong></p>









    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="https://qiuhao123.github.io/" style="background-image: url(/images/logo.png)"><span class="hidden">Qiuhao Jin's Picture</span></a>
    </figure>
    

    








<figure class="author-image">
    <a class="img" href="https://qiuhao123.github.io/" style="background-image: url(/images/logo.png)"><span class="hidden">Qiuhao Jin's Picture</span></a>
</figure>


<section class="author">
  <h4><a href="https://qiuhao123.github.io/">Qiuhao Jin</a></h4>
  
  <p>Read <a href="https://qiuhao123.github.io/">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Durham, NC, USA</span>
    
  </div>
</section>




    
<section class="share">
  <h4>Share this page</h4>
  <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=Star%20War%20Data%20Acuisiqtion&nbsp;-&nbsp;Qiuhao%20Jin&amp;url=https%3a%2f%2fqiuhao123.github.io%2fstarwar%2f"
      onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
      <span class="hidden">Twitter</span>
  </a>
  <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fqiuhao123.github.io%2fstarwar%2f"
      onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
      <span class="hidden">Facebook</span>
  </a>
  <a class="icon-pinterest" style="font-size: 1.4em" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fqiuhao123.github.io%2fstarwar%2f&amp;description=Star%20War%20Data%20Acuisiqtion"
      onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
      <span class="hidden">Pinterest</span>
  </a>
  <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=https%3a%2f%2fqiuhao123.github.io%2fstarwar%2f"
     onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
      <span class="hidden">Google+</span>
  </a>
</section>



    







  </footer>
</article>

</main>

<aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="/phd_analysis/">
          <section class="post">
              <h2>Phd_data_dashboard</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="/spotify_db_normalization/">
          <section class="post">
              <h2>Database Normalization</h2>
          </section>
      </a>
  
</aside>


    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Qiuhao Jin</a> © Qiuhao Jin Duke 2021</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="/js/jquery.js"></script>
    <script type="text/javascript" src="/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/js/index.js"></script>
    
</body>
</html>

